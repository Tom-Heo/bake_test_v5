# Bake

**????? ????.**


## ?? ??

- **OklabP ??? ??** - ?? ??? ?? ?? ?? ????? ?? ?? ??
- **??? ?? ??** - 8/10/12/14/16?? ??? ?? ????, 16?? PNG? ??
- **Self-Supervised ??** - Clean ???? OklabP ?? ??? ???? ?? ?? ?? ??
- **GPU ?? ?????** - ?? ? ?? ??(Flip, Rotation, Curve Distortion)? GPU?? ??
- **Hyper-Baked Loss** - 96?? ??? ?? ???? Log-Charbonnier ?? ?? ??
- **Gradio Web UI** - ?????? Before/After ??, ?? ??, 16?? PNG ????

## ???? ??

```
bake_test_v5/
|-- config.py          # ??????? ? ?? ??
|-- train.py           # ?? ???? (CLI)
|-- inference.py       # ?? ???? (CLI)
|-- app.py             # Gradio ? UI
|-- utils.py           # ?? ??, ??, EMA, ????? ????
|-- data/
|   |-- dataset.py     # BakeDataset (sRGB ??? ??)
|-- core/
    |-- heo.py         # ?? ?? (HeoGate2d, NeMO, SharpLoss ?)
    |-- bake.py        # Baked Color ?? ?? (RBF ?? ?? ??)
    |-- net.py         # BakeNet (Stem - Body 50?? - Head)
    |-- loss.py        # BakeLoss (96ch ?? + Log-Charbonnier)
    |-- augment.py     # BakeAugment (GPU ?? ? ?? ??)
    |-- palette.py     # Palette (sRGB - OklabP ??? ??)
```

## ??

**?? ??**: Python 3.9+, CUDA ?? GPU

```bash
git clone <repository-url>
cd bake_test_v5
pip install -r requirements.txt
```

> PyTorch? CUDA ??? ?? ??? ???? ???. [pytorch.org](https://pytorch.org/get-started/locally/)?? ??? ?? ???? ?????.

## ???

### ??

?? ???? `dataset/paris/` ????? ??? ? ?????.

```bash
# ?? ?? (?????? ??? ?? ??? ??)
python train.py

# ??? ??????? ?? ??
python train.py --resume

# ???? ?? ??
python train.py --restart
```

?????? `checkpoints/last.pth`? ?? ?????.

### ??

```bash
# ?? ???
python inference.py --input path/to/image.png

# ???? ?? ??
python inference.py --input path/to/folder/

# ?? ?? ?? ?? (??? ?? ? ??)
python inference.py --input path/to/folder/ --bit_depth 10

# ?? ????? ??
python inference.py --input image.png --checkpoint path/to/model.pth
```

??? `results/` ????? 16?? PNG? ?????.

### ? UI

```bash
python app.py
```

브라우저에서 단일 이미지 또는 배치 처리가 가능합니다. Before/After 비교 후 16비트 PNG로 다운로드할 수 있습니다.

## ??

[`config.py`](config.py)?? ?? ????? ??? ? ????.

| ?? | ??? | ?? |
|------|--------|------|
| `BATCH_SIZE` | 1 | ?? ?? (??? ?? ??) |
| `INTERNAL_DIM` | 30 | BakeNet ?? ?? ? |
| `TOTAL_EPOCHS` | 10000 | ? ?? ?? |
| `LEARNING_RATE` | 1e-3 | AdamW ??? |
| `WEIGHT_DECAY` | 1e-6 | ??? ?? |
| `SCHEDULER_GAMMA` | 0.999996 | ExponentialLR ??? |
| `EMA_DECAY` | 0.999 | EMA ??? |
| `DEVICE` | `cuda` | ?? ?? |
